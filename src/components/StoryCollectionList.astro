---
import CardStory from "./CardStory";
import type { IStoryCollectionList, IStoryList } from "@/types";

const { collections, stories, path } = Astro.props;
---

<div class="space-y-8">
  {
    collections
      .sort(
        (
          collectionPrev: IStoryCollectionList,
          collectionNext: IStoryCollectionList
        ) => collectionPrev.frontmatter.order - collectionNext.frontmatter.order
      )
      .map(
        (
          collection: IStoryCollectionList & { compiledContent: () => string }
        ) => (
          <div class="space-y-2 pb-12">
            <h2 class="text-2xl md:text-3xl font-bold border-l-4 border-primary pl-4">
              {collection?.frontmatter?.title}
            </h2>
            <div class="text-gray-600 mb-4">
              <Fragment set:html={collection?.compiledContent()} />
            </div>
            <div class="grid grid-cols-1 gap-4 md:grid-cols-2">
              {stories
                .filter(
                  (story: IStoryList) =>
                    story.frontmatter.language === "en" &&
                    collection.frontmatter.stories.includes(
                      story.frontmatter.slug
                    )
                )
                .map((story: IStoryList) => (
                  <CardStory frontmatter={story.frontmatter} path={path} />
                ))}
            </div>
          </div>
        )
      )
  }
</div>
