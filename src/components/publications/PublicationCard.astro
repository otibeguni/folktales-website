---
import { localizePath } from 'astro-i18next';

interface PublicationCardProps {
  title: string;
  description: string;
  cover: string;
  href?: string;
  meta?: string;
}

const { title, description, cover, href = '#', meta = '' } = Astro.props as PublicationCardProps;
const isExternal = /^https?:\/\//.test(href);
const target = isExternal ? '_blank' : undefined;
const rel = isExternal ? 'noreferrer noopener' : undefined;
const normalizedHref = isExternal ? href : localizePath(href);
---

<a
  href={normalizedHref}
  target={target}
  rel={rel}
  class="group relative flex h-full min-h-[520px] flex-col overflow-hidden rounded-2xl border border-slate-100 bg-white p-5 shadow-[0_16px_50px_-44px_rgba(15,23,42,0.6)] transition duration-200 hover:-translate-y-1 hover:shadow-[0_20px_60px_-40px_rgba(15,23,42,0.65)]"
>
  <div class="relative overflow-hidden">
    <img
      src={cover}
      alt={`${title} cover`}
      loading="lazy"
      class="aspect-[2/3] w-full object-cover transition duration-200 group-hover:scale-[1.03]"
    />
    <div class="pointer-events-none absolute inset-0 bg-gradient-to-t from-slate-900/20 via-transparent to-transparent opacity-70" />
  </div>
  <div class="flex flex-1 flex-col gap-3 pt-4">
    <h3 class="text-lg font-semibold leading-tight text-slate-900">{title}</h3>
    {meta && <p class="text-xs text-slate-500">{meta}</p>}
    <p class="text-sm text-slate-700">{description}</p>
  </div>
</a>
